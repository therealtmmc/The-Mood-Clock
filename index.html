<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Mood Alarm Clock</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<style>
/* Base background */
body {
    font-family: 'Montserrat', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #ffffff;
}

/* Dark overlay */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.55);
    z-index: -1;
}

/* App card */
.app {
    background: rgba(15, 15, 15, 0.85);
    backdrop-filter: blur(14px);
    border-radius: 26px;
    padding: 32px 28px;
    width: 340px;
    text-align: center;
    box-shadow: 0 25px 50px rgba(0,0,0,0.6);
}

/* Title */
h1 {
    font-size: 28px;
    margin: 0 0 8px;
    text-shadow: 0 0 15px #00ffcc;
}

.subtitle {
    font-size: 14px;
    opacity: 0.7;
    margin-bottom: 24px;
}

/* Clock */
#time {
    font-size: 56px;
    margin-bottom: 16px;
    text-shadow: 0 0 25px #00ffcc;
}

/* Status */
#status {
    font-size: 16px;
    margin-bottom: 18px;
    line-height: 1.4;
}

/* Mood animation */
.moodAnim {
    <div id="countdown" style="font-size:13px;opacity:0.7;margin-bottom:10px;"></div>
    <div id="history" style="font-size:13px;opacity:0.6;text-align:left;"></div>
    <button id="shareBtn" style="display:none;margin-top:12px;">Share this hour</button>
}

/* Inputs */
#alarmSettings {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 18px;
}

input, select {
    width: 80px;
    padding: 10px;
    font-size: 14px;
    border-radius: 10px;
    border: none;
    background: rgba(0,0,0,0.6);
    color: #00ffcc;
    text-align: center;
    box-shadow: inset 0 0 8px rgba(0,255,204,0.3);
}

/* Button */
#startBtn {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    border-radius: 14px;
    border: none;
    background: #00ffcc;
    color: #0f0f0f;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(0,255,204,0.5);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

#startBtn:hover {
    transform: scale(1.04);
    box-shadow: 0 0 30px rgba(0,255,204,0.8);
}

/* Animations */
@keyframes floatText {
    from { transform: translateY(0); opacity: 0.7; }
    to { transform: translateY(-12px); opacity: 1; }
}
</style>
</head>
<body>

<div class="app">
    <h1>Mood Alarm Clock</h1>
    <div class="subtitle">Every hour carries a feeling</div>

    <div id="time">--:--:--</div>
    <div id="status">Set your alarm time:</div>
    <div id="moodAnim" class="moodAnim"></div>

    <div id="alarmSettings">
        <input type="number" id="hourInput" min="1" max="12" placeholder="HH">
        <input type="number" id="minuteInput" min="0" max="59" placeholder="MM">
        <select id="ampmInput">
            <option value="AM">AM</option>
            <option value="PM">PM</option>
        </select>
    </div>

    <button id="startBtn">Enable Alarm</button>
</div>

<audio id="alarmAudio" preload="auto"></audio>

<script>
/* ---------------- DATA ---------------- */
const songs = {
    happy: ["Surfaces - Sunday Best (Lyrics).mp3"],
    sad: ["One Direction - Night Changes (Lyrics).mp3"],
    exciting: ["PSY - Gangnam Style (1950's Soul Version).mp3"],
    yearn: ["Small Fragile Hearts.mp3"]
};

const moodMessages = {
    happy: "Yay! Todayâ€™s a happy momentâ€”let the smiles take over ðŸŒž",
    sad: "Itâ€™s okay to feel this way. Let the music sit with you ðŸ’™",
    exciting: "Energy risingâ€”letâ€™s go âš¡",
    yearn: "Some feelings donâ€™t need answers ðŸ’­"
};

const moodColors = {
    happy: "rgba(255,200,100,0.15)",
    sad: "rgba(100,150,255,0.15)",
    exciting: "rgba(255,80,80,0.18)",
    yearn: "rgba(180,120,255,0.15)"
};

/* ---------------- STATE ---------------- */
let alarmHour = 0;
let alarmMinute = 0;
let alarmEnabled = false;
let alarmTriggered = false;

const audio = document.getElementById("alarmAudio");
const status = document.getElementById("status");
const moodAnim = document.getElementById("moodAnim");
const countdown = document.getElementById("countdown");
const historyBox = document.getElementById("history");
const shareBtn = document.getElementById("shareBtn");

/* ---------------- UTIL ---------------- */
function getHourKey(date = new Date()) {
    return `${date.toDateString()}-${date.getHours()}`;
}

/* Silent hour (once per day) */
function getSilentHour() {
    const key = new Date().toDateString();
    let silent = localStorage.getItem("silentHour");
    let silentKey = localStorage.getItem("silentHourKey");

    if (silentKey !== key) {
        silent = Math.floor(Math.random() * 24);
        localStorage.setItem("silentHour", silent);
        localStorage.setItem("silentHourKey", key);
    }
    return parseInt(silent);
}

/* Locked mood per hour */
function getLockedMood() {
    const key = getHourKey();
    const savedKey = localStorage.getItem("moodHourKey");

    if (savedKey === key) {
        return {
            mood: localStorage.getItem("lockedMood"),
            song: localStorage.getItem("lockedSong")
        };
    }

    const moods = Object.keys(songs);
    const mood = moods[Math.floor(Math.random() * moods.length)];
    const song = songs[mood][0];

    localStorage.setItem("moodHourKey", key);
    localStorage.setItem("lockedMood", mood);
    localStorage.setItem("lockedSong", song);

    return { mood, song };
}

/* ---------------- ALARM SET ---------------- */
startBtn.onclick = () => {
    const hour = parseInt(hourInput.value);
    const minute = parseInt(minuteInput.value);
    const ampm = ampmInput.value;

    if (isNaN(hour) || isNaN(minute)) return alert("Invalid time");

    alarmHour = ampm === "PM" ? (hour % 12) + 12 : hour % 12;
    alarmMinute = minute;
    alarmEnabled = true;
    alarmTriggered = false;

    status.textContent = "Alarm armed. This hour already has a feeling.";
    alarmSettings.style.display = "none";
    startBtn.style.display = "none";
};

/* ---------------- RESET ---------------- */
audio.onended = () => {
    alarmEnabled = false;
    alarmTriggered = false;
    moodAnim.textContent = "";
    shareBtn.style.display = "none";
    status.textContent = "Set your alarm time:";
    alarmSettings.style.display = "flex";
    startBtn.style.display = "block";
};

/* ---------------- CLOCK ---------------- */
function updateClock() {
    const now = new Date();
    time.textContent = now.toLocaleTimeString();

    if (alarmEnabled) {
        const alarmTime = new Date();
        alarmTime.setHours(alarmHour, alarmMinute, 0);
        const diff = alarmTime - now;
        if (diff > 0) countdown.textContent = `Alarm in ${Math.floor(diff/60000)}m ${Math.floor(diff/1000)%60}s`;
    }

    if (
        alarmEnabled &&
        !alarmTriggered &&
        now.getHours() === alarmHour &&
        now.getMinutes() === alarmMinute
    ) {
        alarmTriggered = true;

        const silentHour = getSilentHour();
        const locked = getLockedMood();

        document.body.style.backgroundColor = moodColors[locked.mood];
        status.textContent = moodMessages[locked.mood];
        moodAnim.textContent = `ðŸŽ§ ${locked.mood.toUpperCase()} HOUR`;

        // Save history
        const history = JSON.parse(localStorage.getItem("history") || "[]");
        history.push(`${now.getHours()}:00 â€” ${locked.mood}`);
        localStorage.setItem("history", JSON.stringify(history.slice(-5)));

        historyBox.innerHTML = "<b>Today</b><br>" + history.join("<br>");

        if (now.getHours() !== silentHour) {
            audio.src = locked.song;
            audio.play();
        } else {
            moodAnim.textContent += " (Silent)";
        }

        shareBtn.style.display = "block";
        shareBtn.onclick = () => {
            navigator.clipboard.writeText(`This hour feels ${locked.mood}.`);
            alert("Copied to clipboard");
        };

        // Progressive trust
        let uses = parseInt(localStorage.getItem("uses") || 0) + 1;
        localStorage.setItem("uses", uses);
        if (uses > 5) status.textContent += " Youâ€™ve been here before.";
    }
}

setInterval(updateClock, 1000);
updateClock();
</script>

</body>
</html>

