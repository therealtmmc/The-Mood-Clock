<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Mood Alarm Clock</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Montserrat', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #ffffff;
}

body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.55);
    z-index: -1;
}

.app {
    background: rgba(15, 15, 15, 0.85);
    backdrop-filter: blur(14px);
    border-radius: 26px;
    padding: 32px 28px;
    width: 360px;
    text-align: center;
    box-shadow: 0 25px 50px rgba(0,0,0,0.6);
}

h1 {
    font-size: 28px;
    margin: 0 0 8px;
    text-shadow: 0 0 15px #00ffcc;
}

.subtitle {
    font-size: 14px;
    opacity: 0.7;
    margin-bottom: 24px;
}

#time {
    font-size: 56px;
    margin-bottom: 16px;
    text-shadow: 0 0 25px #00ffcc;
}

#status {
    font-size: 16px;
    margin-bottom: 12px;
    line-height: 1.4;
}

.moodAnim {
    font-size: 20px;
    margin-bottom: 20px;
    animation: floatText 2s ease-in-out infinite alternate;
}

@keyframes floatText {
    from { transform: translateY(0); opacity: 0.7; }
    to { transform: translateY(-12px); opacity: 1; }
}

#alarmSettings {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 18px;
}

input, select {
    width: 80px;
    padding: 10px;
    font-size: 14px;
    border-radius: 10px;
    border: none;
    background: rgba(0,0,0,0.6);
    color: #00ffcc;
    text-align: center;
    box-shadow: inset 0 0 8px rgba(0,255,204,0.3);
}

#startBtn, .secondaryBtn {
    width: 100%;
    padding: 12px;
    font-size: 15px;
    border-radius: 14px;
    border: none;
    background: #00ffcc;
    color: #0f0f0f;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(0,255,204,0.5);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
    margin-top: 8px;
}

#startBtn:hover, .secondaryBtn:hover {
    transform: scale(1.04);
    box-shadow: 0 0 30px rgba(0,255,204,0.8);
}

.hidden {
    display: none;
}
</style>
</head>
<body>
<div class="app">
    <h1>Mood Alarm Clock</h1>
    <div class="subtitle">Every hour carries a feeling</div>

    <div id="time">--:--:--</div>
    <div id="status">Set your alarm time:</div>
    <div id="moodAnim" class="moodAnim"></div>

    <div id="alarmSettings">
        <input type="number" id="hourInput" min="1" max="12" placeholder="HH">
        <input type="number" id="minuteInput" min="0" max="59" placeholder="MM">
        <select id="ampmInput">
            <option value="AM">AM</option>
            <option value="PM">PM</option>
        </select>
    </div>

    <button id="startBtn">Enable Alarm</button>
    <button id="showHistory" class="secondaryBtn hidden">Show Mood History</button>
    <button id="showMessage" class="secondaryBtn hidden">Show Current Mood Message</button>

    <div id="historyBox" class="hidden" style="margin-top:10px;font-size:13px;text-align:left;"></div>
    <div id="messageBox" class="hidden" style="margin-top:10px;font-size:13px;text-align:left;"></div>
</div>

<audio id="alarmAudio" preload="auto"></audio>

<script>
const songs = {
    happy: ["Surfaces - Sunday Best (Lyrics).mp3"],
    sad: ["One Direction - Night Changes (Lyrics).mp3"],
    exciting: ["PSY - Gangnam Style (1950's Soul Version).mp3"],
    yearn: ["Small Fragile Hearts.mp3"]
};

const moodMessages = {
    happy: "Yay! Todayâ€™s a happy momentâ€”let the smiles take over ðŸŒž",
    sad: "Itâ€™s okay to feel this way. Let the music sit with you ðŸ’™",
    exciting: "Energy risingâ€”letâ€™s go âš¡",
    yearn: "Some feelings donâ€™t need answers ðŸ’­"
};

let alarmHour = 0;
let alarmMinute = 0;
let alarmEnabled = false;
let alarmTriggered = false;

const audio = document.getElementById("alarmAudio");
const status = document.getElementById("status");
const moodAnim = document.getElementById("moodAnim");
const startBtn = document.getElementById("startBtn");
const showHistoryBtn = document.getElementById("showHistory");
const showMessageBtn = document.getElementById("showMessage");
const historyBox = document.getElementById("historyBox");
const messageBox = document.getElementById("messageBox");

function getHourKey(date = new Date()) {
    return `${date.toDateString()}-${date.getHours()}`;
}

function getLockedMood() {
    const key = getHourKey();
    const savedKey = localStorage.getItem("moodHourKey");
    if(savedKey === key){
        return {
            mood: localStorage.getItem("lockedMood"),
            song: localStorage.getItem("lockedSong")
        };
    }
    const moods = Object.keys(songs);
    const mood = moods[Math.floor(Math.random() * moods.length)];
    const song = songs[mood][0];
    localStorage.setItem("moodHourKey", key);
    localStorage.setItem("lockedMood", mood);
    localStorage.setItem("lockedSong", song);
    return { mood, song };
}

startBtn.onclick = () => {
    const hour = parseInt(document.getElementById("hourInput").value);
    const minute = parseInt(document.getElementById("minuteInput").value);
    const ampm = document.getElementById("ampmInput").value;

    if (isNaN(hour) || isNaN(minute)) return alert("Invalid time");

    alarmHour = ampm === "PM" ? (hour % 12) + 12 : hour % 12;
    alarmMinute = minute;
    alarmEnabled = true;
    alarmTriggered = false;

    status.textContent = `Alarm set for ${hour.toString().padStart(2,"0")}:${minute.toString().padStart(2,"0")} ${ampm}`;
    startBtn.style.display = "none";
    document.getElementById("alarmSettings").style.display = "none";
};

audio.onended = () => {
    alarmEnabled = false;
    alarmTriggered = false;
    moodAnim.textContent = "";
    showHistoryBtn.classList.add("hidden");
    showMessageBtn.classList.add("hidden");
};

function updateClock() {
    const now = new Date();
    document.getElementById("time").textContent = now.toLocaleTimeString();

    if(alarmEnabled && !alarmTriggered &&
        now.getHours() === alarmHour &&
        now.getMinutes() === alarmMinute){
        alarmTriggered = true;
        const locked = getLockedMood();

        status.textContent = moodMessages[locked.mood];
        moodAnim.textContent = `ðŸŽ§ ${locked.mood.toUpperCase()} MOOD`;
        audio.src = locked.song;
        audio.play();

        // show buttons
        showHistoryBtn.classList.remove("hidden");
        showMessageBtn.classList.remove("hidden");

        // Save history
        const history = JSON.parse(localStorage.getItem("history") || "[]");
        history.push(`${now.getHours()}:00 â€” ${locked.mood}`);
        localStorage.setItem("history", JSON.stringify(history.slice(-5)));
    }
}

setInterval(updateClock, 1000);
updateClock();

// Button events
showHistoryBtn.onclick = () => {
    const history = JSON.parse(localStorage.getItem("history") || "[]");
    historyBox.innerHTML = history.length ? "<b>Mood History:</b><br>" + history.join("<br>") : "No history yet.";
    historyBox.classList.toggle("hidden");
};

showMessageBtn.onclick = () => {
    const locked = getLockedMood();
    messageBox.textContent = moodMessages[locked.mood];
    messageBox.classList.toggle("hidden");
};
</script>
</body>
</html>

